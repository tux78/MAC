{% macro esmIntegration(currentConfig) %}
  <h3>Enterprise Security Manager (ESM)</h3>
  <div>
    The Enterprise Security Manager Integration provides easy access to the ESM.
    By clicking on JOIN the system will ask for credentials,
    which in turn will be stored locally for subsequent access.
  </div>
  <hr>
  {% if currentConfig %}
    <div>
      Current config:<br>
      {% for line in currentConfig.split('\n') %}
        {{ line }}<br>
      {% endfor %}
        <button type="button" class="btn btn-primary" data-toggle="modal" data-target="#enable-ESM-modal">Update ESM Settings</button>
    </div>
    <hr>
  {% else %}
    <div>
      <button type="button" class="btn btn-primary" data-toggle="modal" data-target="#enable-ESM-modal">Enable</button>
    </div>
  {% endif %}

  <!-- Required Modals -->
  <!-- ESM Enable -->
  <form id="form-ESM-Enable" method="POST">
    <div class="modal fade" tabindex="-1" role="dialog" id="enable-ESM-modal">
      <div class="modal-dialog" role="document">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title">Enable ESM</h5>
            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
              <span aria-hidden="true">&times;</span>
            </button>
          </div>
          <div class="modal-body">
            <div class="form-group">
              <label for="host">Hostname/IP</label>
              <input type="text" class="form-control" id="host" name="host">
            </div>
            <div class="form-group">
              <label for="user">Username</label>
              <input type="text" class="form-control" id="user" name="user" placeholder="admin">
            </div>
            <div class="form-group">
              <label for="password">Password</label>
              <input type="password" class="form-control" id="password" name="password">
            </div>
          </div>
          <div class="modal-footer">
            <input type="hidden" name="model" value="esm">
            <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancel</button>
            <button type="submit" class="btn btn-primary" name="action" value="provision">Save</button>
          </div>
        </div>
      </div>
    </div>
  </form>
{% endmacro %}
